#!/bin/bash

banner() {
	echo "";
	echo "### $1";
}

banner "initialize the assets area";
mkdir -p assets/source && \
	rm -rf assets/dist && \
	mkdir assets/dist;

banner "download all asset sources";
rsync -vham --delete --progress \
	mount/benev-storage/assets/ \
	assets/source;

###
### glbs
###

banner "glbs: potato";
npx @benev/batch 3d glb \
	--verbose \
	--in "assets/source" \
	--out "assets/dist" \
	--tier "potato" \
	--suffix "potato";

banner "glbs: mid";
npx @benev/batch 3d glb \
	--verbose \
	--in "assets/source" \
	--out "assets/dist" \
	--tier "mid" \
	--suffix "mid";

banner "glbs: fancy";
npx @benev/batch 3d glb \
	--verbose \
	--in "assets/source" \
	--out "assets/dist" \
	--tier "fancy" \
	--suffix "fancy";

###
### audio effects
###

banner "audio effects: potato";
npx @benev/batch audio m4a \
	--verbose \
	--in "assets/source/audio/effects" \
	--out "assets/dist/audio/effects" \
	--suffix "potato" \
	--kbps "32" \
	--mono;

banner "audio effects: mid";
npx @benev/batch audio m4a \
	--verbose \
	--in "assets/source/audio/effects" \
	--out "assets/dist/audio/effects" \
	--suffix "mid" \
	--kbps "64" \
	--mono;

banner "audio effects: fancy";
npx @benev/batch audio m4a \
	--verbose \
	--in "assets/source/audio/effects" \
	--out "assets/dist/audio/effects" \
	--suffix "fancy" \
	--kbps "128" \
	--mono;

###
### audio music
###

banner "audio music: potato";
npx @benev/batch audio m4a \
	--verbose \
	--in "assets/source/audio/music" \
	--out "assets/dist/audio/music" \
	--suffix "potato" \
	--kbps "96"

banner "audio music: mid";
npx @benev/batch audio m4a \
	--verbose \
	--in "assets/source/audio/music" \
	--out "assets/dist/audio/music" \
	--suffix "mid" \
	--kbps "128"

banner "audio music: fancy";
npx @benev/batch audio m4a \
	--verbose \
	--in "assets/source/audio/music" \
	--out "assets/dist/audio/music" \
	--suffix "fancy" \
	--kbps "192"

###
### images
###

banner "images: standard";
npx @benev/batch images webp \
	--verbose \
	--in "assets/source" \
	--out "assets/dist" \
	--ignores "graphics/**" \
	--quality "90" \
	--size "1024";

banner "images: graphics";
npx @benev/batch images webp \
	--verbose \
	--in "assets/source/graphics" \
	--out "assets/dist/graphics" \
	--quality "90";

banner "images: levelpics";
npx @benev/batch images webp \
	--verbose \
	--in "assets/source/images/levelpics" \
	--out "assets/dist/images/levelpics" \
	--quality "50" \
	--suffix "small" \
	--size "800";

###
### copy other files
###

banner "copy: other files";
npx @benev/batch copy \
	--verbose \
	--in "assets/source" \
	--out "assets/dist" \
	--find "json,env";

banner "copy: graphics";
npx @benev/batch copy \
	--verbose \
	--in "assets/source/graphics" \
	--out "assets/dist/graphics" \
	--find "*";

